@model ECommerce.WebApp.Models.HomeViewModel

@{
    ViewData["Title"] = "Reflexo Nobre - Móveis de Design Minimalista";
}

<!-- Banner Principal -->
<div class="jumbotron-custom-container">
    <img src="~/images/banner.webp" class="jumbotron-image">
    <div class="jumbotron-content">
        <div class="container">
            <div class="row">
                <div class="col-md-6 offset-md-6 text-end">
                    @*<a href="/products" class="btn btn-custom btn-lg">VEJA MAIS DETALHES</a>*@
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Seção de Ícones/Features (Parcelamento, Desconto, Frete, Produção Própria) -->
<section class="features-icons-section py-4">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-3 col-6 mb-3">
                <i class="bi bi-credit-card d-block mb-2"></i>
                <p class="mb-0">Parcelamento <br> Até 10x Sem Juros</p>
            </div>
            <div class="col-md-3 col-6 mb-3">
                <i class="bi bi-percent d-block mb-2"></i>
                <p class="mb-0">10% de Desconto <br> Em pagamentos no PIX</p>
            </div>
            <div class="col-md-3 col-6 mb-3">
                <i class="bi bi-truck d-block mb-2"></i>
                <p class="mb-0">Envio Rápido <br> Para todo o Brasil</p>
            </div>
            <div class="col-md-3 col-6 mb-3">
                <i class="bi bi-tools d-block mb-2"></i>
                <p class="mb-0">Produção Própria <br> Qualidade Garantida</p>
            </div>
        </div>
    </div>
</section>

<!-- Seção "Navegue pelas Categorias" -->
<section class="container my-5 text-center">
    <h3 class="fw-bold mb-4 text-primary">NAVEGUE PELAS CATEGORIAS</h3>
    @if (Model.categories != null)
    {
        <div class="row">
            @foreach (var category in Model.categories)
            {
                <div class="col-md-3 col-6 mb-4">
                    <a href="/products?categoryId=@category.Id" class="text-decoration-none d-block">
                        <div class="d-flex align-items-center justify-content-center mx-auto mb-2 bg-light rounded-circle shadow-sm" style="width: 150px; height: 150px; overflow: hidden;"> @* bg-light, rounded-circle, shadow-sm *@
                            <img src="~/images/category_icons/@(category.Name.ToLower().Replace(" ", "_")).png" alt="@category.Name" class="img-fluid" style="max-width: 80%; max-height: 80%;">
                        </div>
                        <p class="fw-bold text-dark">@category.Name</p>
                    </a>
                </div>
            }
        </div>
    }
    else
    {
        <p><em>Carregando categorias...</em></p>
    }
</section>

<!-- Seção de Banners de Marketing -->
<section class="container my-5">
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="position-relative overflow-hidden rounded shadow-sm" style="height: 350px;"> @* Contêiner com altura e sombra *@
                <img src="~/images/marketing_homeoffice.jpg" alt="Transforme seu Home Office" class="position-absolute w-100 h-100 top-0 start-0 object-fit-cover"> @* Imagem de fundo *@
                <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center text-center text-white z-1" style="background-color: rgba(0,0,0,0.3);"> @* Overlay com opacidade *@
                    <div class="p-3">
                        <h4 class="fw-bold mb-3">Transforme seu Home Office!</h4>
                        <p class="mb-4">Móveis ergonômicos e estilosos para sua produtividade.</p>
                        <a href="/products?categoryId=4" class="btn btn-primary">VEJA MAIS DETALHES</a> @* btn-primary *@
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="position-relative overflow-hidden rounded shadow-sm" style="height: 350px;">
                <img src="~/images/marketing_salaestar.jpg" alt="Crie a Sala de Estar dos Sonhos" class="position-absolute w-100 h-100 top-0 start-0 object-fit-cover">
                <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center text-center text-white z-1" style="background-color: rgba(0,0,0,0.3);">
                    <div class="p-3">
                        <h4 class="fw-bold mb-3">Crie a Sala de Estar dos Sonhos</h4>
                        <p class="mb-4">Conforto e design para momentos inesquecíveis.</p>
                        <a href="/products?categoryId=1" class="btn btn-primary">VEJA MAIS DETALHES</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Seção "Lançamentos" -->
<section class="container my-5">
    <h3 class="fw-bold mb-4 text-center text-primary">LANÇAMENTOS</h3>
    @if (Model.newProducts != null && Model.newProducts.Any())
    {
        <div class="row">
            @foreach (var product in Model.newProducts)
            {
                <div class="col-md-3 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <img src="@product.ImageUrl" class="card-img-top" alt="@product.Name" style="height: 250px;">
                        <div class="card-body text-center d-flex flex-column">
                            <h5 class="card-title fw-bold">@product.Name</h5>
                            <p class="card-text text-muted small">@product.Description</p>
                            <p class="card-text fs-5 fw-bold text-success">@product.Price.ToString("C")</p>
                            @if (product.Price > 100 && product.Price < 1000)
                            {
                                <p class="card-text text-decoration-line-through text-danger small">@(product.Price / 0.9m).ToString("C")</p>
                                <span class="badge bg-danger position-absolute top-0 end-0 mt-2 me-2">10% OFF</span>
                            }
                            <a asp-controller="Products" asp-action="Details" asp-route-id="@product.Id" class="btn btn-outline-primary mt-auto">Ver Detalhes</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <p class="text-center">Nenhum lançamento no momento.</p>
    }
</section>

<section class="container my-5">
    <h3 class="fw-bold mb-4 text-center text-primary">OS MÓVEIS MAIS VENDIDOS</h3>
    @if (Model.mostSoldProducts != null && Model.mostSoldProducts.Any())
    {
        <div class="row">
            @foreach (var product in Model.mostSoldProducts)
            {
                <div class="col-md-3 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <img src="@product.ImageUrl" class="card-img-top" alt="@product.Name" style="height: 250px; padding-bottom: 200px">
                        <div class="card-body text-center d-flex flex-column">
                            <h5 class="card-title fw-bold">@product.Name</h5>
                            <p class="card-text text-muted small">@product.Description</p>
                            <p class="card-text fs-5 fw-bold text-success">@product.Price.ToString("C")</p>
                            @if (product.Price > 100 && product.Price < 1000)
                            {
                                <p class="card-text text-decoration-line-through text-danger small">@(product.Price / 0.9m).ToString("C")</p>
                                <span class="badge bg-danger position-absolute top-0 end-0 mt-2 me-2">15% OFF</span>
                            }
                            <a asp-controller="Products" asp-action="Details" asp-route-id="@product.Id" class="btn btn-outline-primary mt-auto">Ver Detalhes</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <p class="text-center">Nenhum produto mais vendido no momento.</p>
    }
</section>

<!-- Seção de Newsletter -->
<section class="container my-5 text-center p-5 bg-light rounded shadow-sm"> @* bg-light, rounded, shadow-sm *@
    <h3 class="fw-bold mb-4 text-primary">Fique por dentro das novidades</h3>
    <p class="mb-4">Cadastre-se e receba dicas e novidades de nossa loja.</p>
    <div class="input-group mb-3 mx-auto" style="max-width: 500px;">
        <input type="email" class="form-control" placeholder="Digite o seu e-mail aqui..." aria-label="Recipient's email" aria-describedby="button-addon2">
        <button class="btn btn-dark" type="button" id="button-addon2">Cadastrar</button>
    </div>
</section>

<!-- Informações da CasaVee (texto do rodapé da referência) -->
<section class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <h4 class="fw-bold mb-3 text-primary">Reflexo Nobre, conheça a sua nova loja de móveis favorita!</h4>
            <p>Na Reflexo Nobre, entendemos que a sua casa é o seu refúgio pessoal, um lugar onde cada detalhe reflete a sua personalidade e estilo de vida. E por isso que nos dedicamos a oferecer uma ampla gama de móveis e acessórios de decoração que não apenas preenchem os espaços, mas contam a história única de cada cliente. Seja para transformar completamente um ambiente ou para adicionar um toque de elegância, a CasaVee é a sua parceira confiável! <a href="#" class="text-decoration-none fw-bold text-primary">Leia mais</a></p>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        // Lógica para a busca na navbar (já adicionada no _Layout, mas para a Home Page específica)
        $('#search-button').on('click', function() {
            const searchTerm = $('#search-input').val();
            if (searchTerm) {
                window.location.href = `/products?searchTerm=${encodeURIComponent(searchTerm)}`;
            }
        });
        $('#search-input').on('keypress', function(e) {
            if (e.which === 13) { // Enter key
                $('#search-button').click();
            }
        });
    </script>
}